---
layout: post
title:  "知识图谱-Knowledge-Graph"
date:   2020-06-23 21:14:00
categories: 自然语言处理
tags: 深度学习 NLP KG KB-QA 知识图谱 表示学习 
excerpt: 知识图谱（Knowledge Graph）发展历史，主要类型，前沿研究及应用场景等
author: 鹤啸九天
mathjax: true
---

* content
{:toc}

# 总结


总结如下：

|方法流派|思路|示例|优点|缺点|备注|
|---|---|---|---|---|---|
|规则模板|人为设定规则模板|`AIML`语言|①简单，无须标注②稳定可控|①人力消耗大②回复单一，多样性欠缺|-|
|生成模型|用encoder-decoder结构生成回复|`Seq2Seq`、`transformer`|无须规则，自动生成|①效果不可控②万能回复（安全回复）③多样性低④一致性不足|-|
|检索模型|文本检索与排序技术从问答库中挑选合适的回复|IR|①语句通顺②可控|①不能生成回复②表面相关，难以捕捉语义信息|-|
|混合模型|综合生成和检索方案|度秘|-|-|-|


# 知识图谱

- “知识图谱（Knowledge Graph）”的概念是由Google公司在2012年提出的[1]，指代其用于提升搜索引擎性能的知识库。
- 知识图谱的出现是人工智能对知识需求所导致的必然结果，但其发展又得益于很多其他的研究领域，涉及专家系统、语言学、语义网、数据库，以及信息抽取等众多领域，是交叉融合的产物而非一脉相承
  - 详见：[知识图谱发展概述](https://www.cnblogs.com/jtianwen2014/p/7678616.html)

![](https://images2017.cnblogs.com/blog/706575/201710/706575-20171016200824396-1450295689.png)

## 历史

- 知识图谱的发展简史
  - 上个世纪60年代Quillian提出了语义网络，作为知识表示的一种方式，用于描述物体概念与状态及其间的关系，早期主要是用来帮助自然语言理解。
  - 到上个世纪80年代，人工智能研究人员将 “本体”这一哲学概念被引入计算机领域，把本体定义为“概念和关系的形式化描述”，通俗一点讲本体类似数据库中的Schema，这一时期的一个典型应用就是专家系统。
  - 1989年Tim Berners Lee提出了万维网，也就是我们今天使用的www网络
  - 1998年从超文本网页延伸出语义网络概念，将每一个网页引入语义信息，比如：姚明这个页面，归属类别是人物、运动员。
  - 2006年提出了链接数据概念，目标将互联网上所有数据建立关联，如姚明的页面出现他妻子叶莉，会给“叶莉”加一个链接，链接到叶莉这个页面。
  - 2012年Google率先提出了知识图谱，目的是提升整个搜索效果，从此知识图谱技术开始得到广泛学习和应用。
- ![](http://5b0988e595225.cdn.sohucs.com/images/20180906/2cbe3385c1b74d2895626b0070c72b44.jpeg)
  - 摘自：[知识图谱在贝壳找房的从0到1实践](https://www.sohu.com/a/252223730_499730)

## 定义

- 定义[Wang, 2017]： 
  - 知识图谱是由`实体`和`关系`构成的`多关系图`，实体和关系分别被视为节点和不同类型的边。
> A knowledge graph is a multirelational graph composed of entities and relations which are regarded as nodes and different types of edges, respectively.
- 形式化定义： 
> A knowledge graph as G = {E, R, F}, where E, R and F are sets of entities, relations and facts, respectively. A fact is denoted as a triple (h, r, t) ∈ F。

- 摘自：[戴帅湘：NLP的发展和应用](https://mp.weixin.qq.com/s?__biz=MzIyNTk1OTY5NQ==&mid=2247483751&idx=1&sn=e8af45990756375f8f3bb42e841a0e91&chksm=e8768b07df0102116fd449b4e685086b25922a6a9436fe5f05490a152fa579ecf9bb05db81cf&mpshare=1&scene=23&srcid=&sharer_sharetime=1593153276858&sharer_shareid=b8d409494a5439418f4a89712efcd92a#rd)

- 知识图谱旨在描述真实世界中存在的各种实体或概念及其间的关联关系。
  - 首先，每一个实体用全局唯一ID来标识，就如同每个人都有一个自己的身份证号；
  - 其次就是用属性-值对来刻画实体的内在特性，用关系来刻画实体之间的关联。
  - 如刻画姚明这个实体：属性-值<姚明+身高+2.26米>，关系型<姚明+妻子+叶莉>。

![](http://5b0988e595225.cdn.sohucs.com/images/20180906/74e9cf11143945ad88032e4c97e26e47.jpeg)


## 应用

- 知识图谱应用场景分为两种，一种是通用领域，一种是垂直领域
  - 通用领域如Google搜索，国内百度和搜狗也有在搜索中应用知识图谱技术；还有些智能硬件应用，如智能机器人、智能手表。这种应用也会用到通用知识图谱，构建依赖国外维基百科、freebase，还有国内百度百科、维基百科、互动百科、搜狗百科等，从这些页面中抽取出结构化三元组构建知识图谱来支撑通用领域的问答和搜索。
  - 垂直领域应用越来越多，如金融、电商、公共安全、电信等，具体如金融里面的反欺诈，公共安全领域的追捕犯罪分子。

![](http://5b0988e595225.cdn.sohucs.com/images/20180906/ada176a7e37a45c3989aba8dd372ad54.jpeg)


## 技术架构

- 1. `知识表示` 
  - 在知识库中，用RDF表示，是一个`三元组`(triple)模型，即每个知识可被分解为`主` (subject)、`谓`(predicate)、`宾`(object)； 
- 2. `知识表示学习`(Knowledge Representation Learning，KRL) 
  - 2.1 定义：表示学习旨在将三元组语义信息表示为<font color='blue'>稠密低维实值向量</font>，知识表示学习则面向知识库中的实体和关系进行表示学习 
  - 2.2 意义：知识表示是知识获取与应用的基础；知识表示学习得到的分布式表示有以下典型应用 
    - **实体相似度计算**，如实体链接(Entity Linking，EL) 
    - **知识图谱补全**(Knowledge Graph Completion，KGC) 
    - 其他，如**关系抽取**，**自动问答**等 
  - 2.3 目标：将知识图谱编码到向量空间：(subject, predicate, object) => (head, relation, tail) 
  - 2.3 现状：在学术界研究方向和趋势详细阐述


## 知识抽取

非结构化（纯文本）知识抽取分三个任务： 
- 1. `实体提取`(Entity Discovery) 
  - 细分任务分为：
    - `实体识别`(Entity Recognition)
    - `实体消歧`(Entity Disambiguation)
    - `实体分类`(Entity Typing)
    - `实体对齐`(Entity Alignment)
- 2. `关系提取`(Relation Extraction) 
  - 2.1 定义：关系抽取是从非结构化数据中抽取未知关系事实并将其加入到知识图谱中，是自动构建大规模知识图谱的关键 
  - 2.2 方法：传统的方法高度依赖于特征工程。由于缺乏标记的关系数据，使用启发式匹配来创建训练数据，利用文本特征(包括词汇和句法特征、命名实体标记和连接特征)对关系分类进行远程监控。目前最新研究以深度学习工具实现关系提取。
- 3. `知识补全`(KGC) 
  - 3.1 基于知识图谱不完备性的特点，提出了一种新的知识图谱三元组生成方法。即，给定一个不完整的知识图谱 G=(E, R, F)，知识图谱补全旨在推理出缺失的三元组 T={(head, relation, tail) \| (head, relation, tail) ∉ F} 。
  - 3.2 典型的子任务包括：
    - `链路预测`(Link Prediction)
    - `实体预测`(Entity Prediction)
    - `关系预测`(Relation Prediction) 
  - 3.3 方法：
    - `基于Embedding`(Embedding-based Models)
    - `关系路径推理`(Relation Path Reasoning)
    - `基于规则的推理`(RL-based Path Finding)

# 表示学习

## 基础知识

- 【2016-1-19】[刘知远：面向大规模知识图谱的表示学习技术](http://www.cbdio.com/BigData/2016-03/03/content_4675344.htm)，讲座解析
  - ![](http://www.cbdio.com/image/attachement/jpg/site2/20160303/94de80684e4418423b2e30.jpg)
  - ![](http://www.cbdio.com/image/attachement/jpg/site2/20160303/94de80684e4418423b6406.jpg)
  - ![](http://www.cbdio.com/image/attachement/jpg/site2/20160303/94de80684e4418423bdd06.jpg)
  - ![](http://www.cbdio.com/image/attachement/jpg/site2/20160303/94de80684e4418423c221a.jpg)
  - ![](http://www.cbdio.com/image/attachement/jpg/site2/20160303/94de80684e4418423c361c.jpg)
  - TransH和TransR均为TransE代表扩展模型之一，其中TransH由MSRA研究者提出，TransR由清华实验室提出。
    - TransE在实体预测任务能够达到47.1的准确率，而采用TransH和TransR，特别是TransR可以达到20%的提升。
  - [基于 TransE TransH TransR和PTransE的知识图](https://www.helplib.cn/fansisi/KB2E)，[KB2E](https://www.github.com/thunlp/KB2E)代码实现

## 关系推理

- 简单问答只需要识别出问题中的实体和关系，链接到知识图谱中，即可查出答案。
- 推理问答则要求计算机具备多种推理能力，具体包括：
  - （1）处理多跳关系的能力，如“姚明的妻子的学校”；
  - （2）数值比较的能力，如“哪个城市的人口更多”；
  - （3）集合操作的能力，如“即是篮球运动员，又是球队老板的人有哪些”。
- 知识图谱推理问答主流方法大致分为4大类别
  - 键值记忆网络（KVMemNet）
  - 基于强化学习的多跳路径搜索
  - 弱监督的程序学习
  - 查询图解析与匹配
- 资料
  - [知识图谱推理问答：如何让机器像人类一样学会推理](https://www.toutiao.com/i6842470279516520972/)

- 基于知识图谱的关系推理的相关工作，大体分为三种方法：
  - 首先是统计关系学习方法（SRL），如马尔科夫逻辑网络、贝叶斯网络，但这类方发需要设计相应的规则，因此没有很好的扩展性和泛化性；
  - 嵌入式表示的方法，旨在将实体和关系映射为空间中的向量，通过空间中向量的运算来进行推理（如TransE），该方法取得了较好的准确率，但分布式表示的解释性不强，另外，较难实现并行计算；
  - 基于关系路径特征的随机游走模型，该方法可以进行并行计算，具有较好的执行效率，但准确率与召回率相比嵌入式表示学习的方法存在劣势。

### 推理数据集

- 4个常用推理问答数据集，并从所用知识库、知识类型、问题数量、自然语言、SPARQL共5个角度加以对比。
  - 三种知识类型：
    - ①关系型，如（“姚明”，“出生于”，“上海”）；
    - ②属性型，如（“姚明”，“身高”，“ 229 厘米”）；
    - ③事实型，用于表示一个关系型事实或属性型事实的知识，如[（“上海”，“人口”，“23,390,000”），“统计时间”，“2016”]。
    - ![](http://p1-tt.byteimg.com/large/pgc-image/bfbadfacd0cf40dba276f6a3e0c70f33?from=pc)
    - 在提到的4个数据集中，MetaQA 和 CSQA 仅考虑关系型知识。
  - 现有数据集存在一个共同的问题，都缺乏推理过程，只给出复杂的问题以及对应的答案，没有问题解答过程。
  - 清华大学知识工程实验室构造了一个新的数据集——KQA Pro，可提供之前数据集都不具备的推理过程。
    - ![](http://p3-tt.byteimg.com/large/pgc-image/cb3ae03cd46d4a8db6ebbb1375275293?from=pc)
  - 为表示推理过程，KQA Pro引入函数（function）和程序（program）两个概念。函数对应简单问题，程序对应复杂问题，将简单的函数组合成复杂的程序，从而解决复杂问题。
    - ![](http://p6-tt.byteimg.com/large/pgc-image/08a168a57ec644268e16264598f910aa?from=pc)

## 常识推理

- [“原子”因果常识图谱](https://www.hankcs.com/nlp/corpus/atomic-commonsense-knowledge-graph.html)
  - AAAI19的论文(Sap et al. (2019))开源了一个包含87万条推理常识的知识图谱ATOMIC。相较于常见的基于本体论分类条目的知识图谱，该知识库专注于“如果…那么…”关系的知识。作者提出了9种类型的因果联系来区分原因-效果、主体-主题、自愿-非自愿、行动-心理状态。通过生成式训练，作者发现神经网络模型可以从该图谱中获取简单的常识推理能力。
  - 另外，该团队在ACL19上的论文COMET则利用了该图谱训练GPT模型，该GPT模型又反过来生成了许多全新的且合理的知识，达到了图谱补全的效果。
  - ![](https://wx1.sinaimg.cn/large/006Fmjmcly1g91wq3pvxkj30u012lh1q.jpg)

## 问题思考

- 目前已有的知识表示学习方法无法实现精确链接预测，有两个原因导致了这一现象的出现：
  - ill-posed algebraic problem：一个方程组中的方程式个数远大于变量个数
    - 解法：流形函数, M(h,r,t)=D2r用来代替$h_r+r=t_r$，应用Reproducing Kernel Hilbert Space (RKHS)映射到Hilbert空间，以更高效地表征流形
      - ![](https://images2015.cnblogs.com/blog/706575/201706/706575-20170619113807148-873845996.png)
  - adopting an overstrict geometric form。应用于h+r=t，所得到的尾实体几乎是一个点，这对于多对多关系而言显然是不正确的

- 摘自：知识图谱表示学习与关系推理（2016-2017）：[（一）](https://www.cnblogs.com/jtianwen2014/p/7000190.html)，[（二）](https://www.cnblogs.com/jtianwen2014/p/7008228.html)，[（三）](https://www.cnblogs.com/jtianwen2014/p/7018872.html)，[ACL2016信息抽取与知识图谱相关论文掠影](https://www.cnblogs.com/jtianwen2014/p/6985214.html)


# 事理图谱-Event Graph

- [白硕：事理图谱六问六答 ](https://www.sohu.com/a/330151320_657157)
  - 知识图谱，主要表示的是关于实体的知识，发展得比较丰富的还是围绕实体、关系、属性的各种表示、演化和推理技术。
  - 哈工大事理图谱1.0版用的是“Event Evolution Graph”，2.0版用的是“Event Logic Graph”，国外同领域文献用得比较多的是“Event Graph”。
- 一、**事理图谱是研究“事理”的学问吗？**
  - “事理图谱”不研究事理的内容，只研究事理“长什么样”，可以说是关于事理的形式化、数字化表示、演化和推理的学问。
- 二、**事理图谱和事件图谱是什么关系？**
  - 事件图谱是不含本体的事理图谱，是事理图谱的初级阶段。对事件实例的抽取和预测，是事件图谱的基本任务。
  - 事件图谱走向事理图谱又是一个学科方向的内在逻辑不断推动和一些应用领域的知识图谱落地需求不断倒逼的综合作用结果。
- 三、**事理图谱的本体层需要什么样的架构来支持？**
  - 事理图谱有本体层，这是个最重要的结论。事件之间、事件和实体之间不仅有横向的由此及彼的关联，还有纵向的由特殊到一般/由一般到特殊的关联。
    - 横向关联：由此及彼，是漫游、是联想、是类比
    - 纵向关联：一般<-->特殊，是归纳、是演绎、是演化。
  - 四象限架构
    - 抽象实体、具体实体、抽象事件、具体事件这四块内容，物理上是联通的，是一张图，逻辑上则可以左右划分为实体域和事件域，上下可以划分为本体域和实例域，形成所谓“四象限”架构
    - ![](http://5b0988e595225.cdn.sohucs.com/images/20190729/8441ff086e204877a5e6e009504a417c.png)
- 四、**事理图谱和实体图谱是什么关系？**
  - 事理图谱是在知识图谱总框架下，知识表示对象从实体、关系、属性向事件的顺理成章的延伸。当然，随着延伸，也自然而然产生了“四象限”的架构，以及由这种架构带来的丰富得多的计算、演化和推理模式。
  - 事理图谱也和实体图谱一样，受到知识图谱构建所遵循的一般规律特别是一般性方法论原则的约束。
- 五、**事理图谱和NLP如何对接？**
  - 事理图谱是对谓词性成分语义进行表示的技术体系，因此事理图谱的研究和NLP有着天然的紧密联系。
  - 事理图谱向左，可以“脑补”一般分析器做不到的精准解析结果，如指代消解
  - 事理图谱向右，可以“补脑”语义落地所缺失的环节，扫除一旦精准NLP得以实现之后通向应用场景的各种障碍
- 六、**事理图谱适合在哪些应用场景落地？**
  - 有些应用场景，只要实体域的两个象限就很好了，完全不需要引入事件域这两个象限。如，教育领域。
  - 金融、情报、法律、医疗，是事理图谱应用的“重仓”

![](http://5b0988e595225.cdn.sohucs.com/images/20190729/ef48f3a4c2ea4b36a1f3ba5f7b10e272.jpeg)


# KB-QA

- IRQA
- KBQA
- MRCQA

# 图数据库

- [越来越火的图数据库究竟是什么？](https://www.cnblogs.com/mantoudev/p/10414495.html)

> 随着社交、电商、金融、零售、物联网等行业的快速发展，现实社会织起了了一张庞大而复杂的关系网，传统数据库很难处理关系运算。大数据行业需要处理的数据之间的关系随数据量呈几何级数增长，亟需一种支持海量复杂数据关系运算的数据库，`图数据库`应运而生。

世界上很多著名的公司都在使用图数据库。比如：
- 社交领域：Facebook, Twitter，Linkedin用它来管理社交关系，实现好友推荐
- 零售领域：eBay，沃尔玛使用它实现商品实时推荐，给买家更好的购物体验
- 金融领域：摩根大通，花旗和瑞银等银行在用图数据库做风控处理
- 汽车制造领域：沃尔沃，戴姆勒和丰田等顶级汽车制造商依靠图数据库推动创新制造解决方案
- 电信领域：Verizon, Orange和AT&T 等电信公司依靠图数据库来管理网络，控制访问并支持客户360
- 酒店领域：万豪和雅高酒店等顶级酒店公司依使用图数据库来管理复杂且快速变化的库存

## 关系型数据库

- 关系型数据库实际上是不擅长处理关系的
  - 关系型数据库
    - ![](https://s3.amazonaws.com/dev.assets.neo4j.com/wp-content/uploads/20180716185458/relational-database-rdbms-model-example.jpg)
  - 图数据库
    - ![](https://s2.ax1x.com/2019/02/21/kR4tKg.md.png)
- 在数据关系中心，图形数据库在查询速度方面非常高效，即使对于深度和复杂的查询也是如此。在《Neo4j in Action》这本书中，作者在关系型数据库
和图数据库(Neo4j)之间进行了实验。
  - 在深度为2时（即朋友的朋友），两种数据库性能相差不是很明显；
  - 深度为3时(即朋友的朋友的朋友)，很明显，关系型数据库的响应时间30s，已经变得不可接受了；
  - 深度到4时，关系数据库需要近半个小时才能返回结果，使其无法应用于在线系统；
  - 深度到5时，关系型数据库已经无法完成查询。而对于图数据库Neo4J，深度从3到5，其响应时间均在3秒以内。
- 可以看出，对于图数据库来说，数据量越大，越复杂的关联查询，约有利于体现其优势。从深度为4/5的查询结果我们可以看出，图数据库返回了整个社交网络一半以上的人数。

## NoSQL数据库

大致可以分为四类：
- 键值(key/value)数据库
- 列存储数据库
- 文档型数据库
- 图数据库

![](https://s3.amazonaws.com/dev.assets.neo4j.com/wp-content/uploads/20181025032156/nosql-databases-overview.png)

- 表格对比

| 分类 |	数据模型 |	优势 |	劣势	| 举例 |
|---|---|---|---|---|
|键值数据库	|哈希表	|查找速度快	|数据无结构化，通常只被当作字符串或者二进制数据|	Redis|
|列存储数据库|	列式数据存储|	查找速度快；支持分布横向扩展；数据压缩率高|	功能相对受限|	HBase|
|文档型数据库	|键值对扩展	|数据结构要求不严格；表结构可变；不需要预先定义表结构	|查询性能不高，缺乏统一的查询语法|	MongoDB|
|图数据库|	节点和关系组成的图|	利用图结构相关算法(最短路径、节点度关系查找等)|	可能需要对整个图做计算，不利于图数据分布存储|	Neo4j、JanusGraph|

## 什么是图数据库？

图数据库(Graph database)并非指存储图片的数据库，而是以图这种数据结构存储和查询数据。

图形数据库是一种在线数据库管理系统，具有处理图形数据模型的创建，读取，更新和删除（CRUD）操作。

与其他数据库不同，关系在图数据库中占首要地位。这意味着应用程序不必使用外键或带外处理（如MapReduce）来推断数据连接。

与关系数据库或其他NoSQL数据库相比，图数据库的数据模型也更加简单，更具表现力。

图形数据库是为与事务（OLTP）系统一起使用而构建的，并且在设计时考虑了事务完整性和操作可用性。

两个重要属性
- 根据存储和处理模型不同，市面上图数据库也有一些区分。
- 比如：
  - Neo4J就是属于原生图数据库，它使用的后端存储是专门为Neo4J这种图数据库定制和优化的，理论上说能更有利于发挥图数据库的性能。
  - 而JanusGraph不是原生图数据库，而将数据存储在其他系统上，比如Hbase。

- ① 图存储
  - 一些图数据库使用原生图存储，这类存储是经过优化的，并且是专门为了存储和管理图而设计的。并不是所有图数据库都是使用原生图存储，也有一些图数据库将图数据序列化，然后保存到关系型数据库或者面向对象数据库，或其他通用数据存储中。
- ② 图处理引擎
  - 原生图处理（也称为无索引邻接）是处理图数据的最有效方法，因为连接的节点在数据库中物理地指向彼此。非本机图处理使用其他方法来处理CRUD操作。

## Neo4j

- Neo4J是由Java实现的开源图数据库。自2003年开始开发，直到2007年正式发布第一版，并托管于GitHub上。
- Neo4J支持ACID，集群、备份和故障转移。目前Neo4J最新版本为3.5，分为社区版和企业版，社区版只支持单机部署，功能受限。企业版支持主从复制和读写分离，包含可视化管理工具。

- 标记属性图模型
  - 节点
  - 关系
  - 属性
  - 标签
- ![](https://s3.amazonaws.com/dev.assets.neo4j.com/wp-content/uploads/20170731095054/Property-Graph-Concepts-Simple.svg)

### Cypher

- Cypher是Neo4j的图形查询语言，允许用户存储和检索图形数据库中的数据。
- 查询语言如下：
```sql
MATCH 
  (person:Person)-[:KNOWS]-(friend:Person)-[:KNOWS]-
  (foaf:Person)
WHERE 
  person.name = "Joe"
  AND NOT (person)-[:KNOWS]-(foaf)
RETURN
  foaf
```
![](https://s2.ax1x.com/2019/02/21/kRocM8.png)

## JanusGraph

- 一个Linux基金会下的开源分布式图数据库 。JanusGraph提供Apache2.0软件许可证。该项目由IBM、Google、Hortonworks支持。JanusGraph是由TitanDB 图数据库修改而来，TitanDB从2012年开始开发。目前最新版本为0.3.1。


## DGraph

- dgraph 是可扩展的，分布式的，低延迟的图数据库。
- DGraph 的目标是提供 Google 生产水平的规模和吞吐量，在超过TB的结构数据里，为用户提供足够低延迟的实时查询。DGraph 支持 [GraphQL](https://www.oschina.net/p/graphql) 作为查询语言，响应 JSON。
- 对比
  - ![](https://static.oschina.net/uploads/space/2017/1119/092808_e1XO_12.jpg)

# 资料

- 更多[Demo地址](http://wqw547243068.github.io/demo)

# 结束



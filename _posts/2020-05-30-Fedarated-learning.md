---
layout: post
title:  "联邦学习"
date:   2020-05-30 08:27:00
categories: 机器学习
tags: 机器学习 联邦学习
excerpt: 如何保护用户隐私的同时也能充分利用各类数据？
author: 鹤啸九天
mathjax: true
---

* content
{:toc}

# 总结


# 联邦学习介绍

## 常规机器学习的问题

- “集中式”模型训练
    - 设备(pc/phone)→服务器→API/gRPC
- 问题
    - 无法保证用户隐私保护——数据被服务器收集
    - 那以保证低时延——实时服务

## 大数据时代的机器学习困境

- 小数据
    - 数据和特征是模型和算法的上确界
    - 高质量、有标准的数据往往是小数据
- 数据孤岛
    - 中国的数据主要掌握在政府、运营商、互联网企业等三大“数据岛屿群”中，岛屿群间相互割裂，彼此孤立，甚至在岛屿群内部，或某一特定岛屿（企业）中，数据也并不是一个可方便流通的整体，而呈各自分散的“岛中岛”状态。
- 安全隐私
    - 5月6日，脱口秀演员王越池（艺名“池子”）在微博发布长文指责中信银行上海虹口支行在未经其本人授权的情况下，向与其有经济纠纷的笑果文化泄露其个人账户交易明细，再次引发人们对于自身信息安全的热议
    - 央视：别把用户信息扔出池子！

## 隐私保护立法

- 国际
    - 2018年6月13日，英国Dixons Carphone （跨国电信公司）宣布调查“大量客户数据被非法访问”事件。黑客“试图在Currys PC World和Dixons旅行商店的一个处理系统中破坏客户590万张卡和120万张包含非财务数据的记录，如姓名、地址或电子邮件地址……”这是英国有史以来最大的数据泄露事件
    - 1998年英国数据保护法
    - 2018年，欧盟一般数据保护条例（GDPR）生效
        - 2019年1月22日，法国监管机构对Google开出了首笔GDPR罚款，金额达5000万欧元（约5700万美元）
        - GDPR其中一条：可以用来大数据分析，提升用户体验，但不能用于别的场景，如训练对话系统等
- 国内

## 什么是联邦学习

- 2017 年 Google 发表 Federated Learning
- Blaise：
    - 能否用一个大型分布式神经网络模型训练框架，让用户数据不出本地（在自己的设备中进行训练）的同时也能获得相同的服务体验？
    - 可以！上传权重，而不是数据
        - 人会在睡觉的时候通过做梦来更新自己的大脑认知系统；
        - 同样设备终端的系统也可以通过闲置时进行模型训练和更新。
    - 设备端联邦学习
        - 用户本地训练，加密上传训练模型（权重），服务器端会综合成千上万的用户模型后再反馈给用户模型改进方案


# 联邦学习原理

## 联邦？

- 一种国家政体几个成员国（如共和国或邦、州等）联合组成统一国家​
- 联邦同成员国间的权限划分由联邦宪法规定。​
- 各成员国按联邦宪法规定，设自己的立法机关和行政机关，制定自己的宪法和法律，在自己辖区内行使职权。​
    - 如：美国、加拿大、澳大利亚、英国、俄罗斯、巴基斯坦等​
- 邦联：多个国家结盟，邦联包含联邦

## 联邦学习基本过程

- 要点
    - 上传非对称加密的权重到服务器，云端算法聚合，更新模型并下发
- 设备端联邦学习过程
    - 设备端下载当前版本的模型；
    - 通过学习本地数据来改进模型；
    - 把对模型的改进，概括成一个比较小的更新；
    - 该更新被加密发送到云端；
    - 与其他用户的更新即时整合，作为对共享模型的改进。
- 关键环节
    - 根据用户使用情况，每台手机在本地对模型进行个性化改进；
    - 形成一个整体的模型修改方案；
    - 应用于共享的模型。该过程会不断循环。

## 同态加密

- 同态性源自抽象代数（近世代数），群、环、域、理想、四元数
- 同态加密是其中一个应用
- 原理
    - 加密算法可以隔着加密层去进行运算，完成任意算法的运算
    - 类似线性代数里的加法+数乘运算


# 联邦学习分类

## 总结

- 联邦学习具有以下特点：
    - 在联邦学习的框架下，各参与者地位对等，能够实现公平合作；
    - 数据保留在本地，避免数据泄露，满足用户隐私保护和数据安全的需求；
    - 能够保证参与各方在保持独立性的情况下，进行信息与模型参数的加密交换，并同时获得成长；
    - 建模效果与传统深度学习算法建模效果相差不大；
    - 联邦学习是一个「闭环」的学习机制，模型效果取决于数据提供方的贡献。


# 应用

## 风控

- 多维度联邦数据建模，风控模型效果约可提升12%，相关企业机构有效节约了信贷审核成本，整体成本预计下降5%-10%，并因数据样本量的提升和丰富，风控能力进一步增强。

## 医疗

- 腾讯天衍实验室公开宣布，其联合微众银行研发的医疗联邦学习，在脑卒中预测的应用上，准确率在相关数据集中高达80%。


## 安防

- 微众银行AI部门副总经理陈天健透露，“在‘联邦视觉系统’项目中，通过联邦学习技术，整体模型的性能提升了15%，且模型效果无损失，极大地提升了建模效率。”

# 工程实现

- 开源FL工具包FATE
- Tensorflow工具包：FFT

# 资料

- [2019年全球架构师峰会](https://archsummit.infoq.cn/2019/shenzhen/schedule)
- 【InfoQ】[陈天健：基于联邦学习新技术连接数据孤岛](https://static001.geekbang.org/con/40/pdf/2790523233/file/%E9%99%88%E5%A4%A9%E5%81%A5-%E5%9F%BA%E4%BA%8E%E8%81%94%E9%82%A6%E5%AD%A6%E4%B9%A0%E6%96%B0%E6%8A%80%E6%9C%AF%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%AD%A4%E5%B2%9B.pdf)
- [联邦学习诞生1000天的真实现状](https:/www.leiphone.com/news/202004/rfPSGIjbS38DqTsm.html)
- [联邦学习tensorflow工具包](https://www.tensorflow.org/federated?hl=zh-cn)
- 书籍：杨强的《联邦学习》


# 结束



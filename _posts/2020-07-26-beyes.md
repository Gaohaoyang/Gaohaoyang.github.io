---
layout: post
title:  "贝叶斯系列-Bayes"
date:   2020-07-26 15:02:00
categories: 数学基础 机器学习
tags: 贝叶斯 频率学派 贝叶斯学派 点估计 分布估计 参数估计 区间估计 MLE MAP
excerpt: 贝叶斯理论及相关知识点
author: 鹤啸九天
mathjax: true
---

* content
{:toc}


# 资料

- [六大概率分布](http://www.csuldw.com/2016/08/19/2016-08-19-probability-distributions/)
- 【2018-11-15】数说工作室：[概率论-上帝的赌术](https://mp.weixin.qq.com/s?__biz=MjM5MDEzNDAyNQ==&mid=200838250&idx=1&sn=d0efd4cfa4a79112ebd43009c57c22eb&scene=19#wechat_redirect)，协和八：说人话的统计学，[做统计，多少数据才算够](https://mp.weixin.qq.com/s?__biz=MzAxMDA4NjU3OA==&mid=207643438&idx=1&sn=20fbf90250185008f841fffe28bf4e9b&scene=1&srcid=0710wI1mdNbPso36OkPa9LXY#rd)，【2018-5-20】【精华】[说人话的统计学-合集](https://mp.weixin.qq.com/s?__biz=MzAxMDA4NjU3OA==&mid=401048178&idx=1&sn=b8e79ee70f99fcc6a6c3f7c51c3c3f96&chksm=094693af3e311ab915b1a0675cdd05eec8a04125a12dd6f568105a1685438c7e3e9c8015ea6f&mpshare=1&scene=23&srcid=0710wjvWkpUbrUlCJqkEZQvd&sharer_sharetime=1587351730042&sharer_shareid=b8d409494a5439418f4a89712efcd92a#rd)，【2019-08-30】[统计之都](https://cosx.org/)，【2020-3-11】[概率统计思维的建立](https://zhuanlan.zhihu.com/p/112172344)

- 【2018-8-13】[贝叶斯概率模型一览](https://www.toutiao.com/a6585030992715579911/?tt_from=mobile_qq&utm_campaign=client_share&timestamp=1534170408&app=news_article&utm_source=mobile_qq&iid=39213720304&utm_medium=toutiao_android&group_id=6585030992715579911)，[贝叶斯概率-精简讲解](https://www.toutiao.com/a6696083742659707400/?tt_from=android_share&utm_campaign=client_share&timestamp=1559173967&app=news_article_lite&utm_medium=toutiao_android&req_id=20190530075247010023072207214183F&group_id=6696083742659707400)
  - ![](http://p6-tt.byteimg.com/large/a06d00076f15d3682ffe)
  - 统计学习根据任务类型可以分为监督学习、半监督学习、无监督学习、增强学习等
  - 每类任务中，又可以将各类模型归结为概率模型和非概率模型，以监督学习为例
    - `概率模型`(`生成模型`)通过函数 F 来描述 X 和 Y 的联合概率或者条件概率分布，如 P(X\|Y)；
    - `非概率模型`（`判别模型`）通过函数 F 来直接描述 X 到 Y 的映射，如 Y = f(X)。
- 【2018-8-16】[可视化讲解贝叶斯推断](http://students.brown.edu/seeing-theory/bayesian-inference/index.html#section3)
- 【2018-9-7】深度学习与贝叶斯暑期培训教程[DeepBayes](http://deepbayes.ru/),含ppt、视频，github地址：[Seminars DeepBayes Summer School 2018](https://github.com/bayesgroup/deepbayes-2018)，[video视频](https://www.youtube.com/playlist?list=PLe5rNUydzV9Q01vWCP9BV7NhJG3j7mz62),[slides资料](https://drive.google.com/drive/folders/1rJ-HTN3sNTvhJXPoXEEhfGlZWtjNY26C)
- 【2018-11-30】[透彻理解马尔科夫蒙特卡洛](https://www.toutiao.com/a6627436642611233294/?tt_from=mobile_qq&utm_campaign=client_share&timestamp=1543535821&app=news_article&utm_source=mobile_qq&iid=52365900690&utm_medium=toutiao_android&group_id=6627436642611233294)，马尔科夫链可视化讲解[Markov Chains](http://setosa.io/ev/markov-chains/)
- 【2018-11-29】[透彻理解最大似然估计](https://www.toutiao.com/a6625581290538140167/?tt_from=mobile_qq&utm_campaign=client_share&timestamp=1543506091&app=news_article&utm_source=mobile_qq&iid=52365900690&utm_medium=toutiao_android&group_id=6625581290538140167)
- [统计学基础知识【脑图笔记】](http://www.cnblogs.com/xiaofeng1234/p/5987845.html)


# 基本概念


## 概率与统计

- 概率论和统计学的区别
  - 简单来说，概率论和统计学解决的问题是互逆的。假设有一个具有不确定性过程（process），然后这个过程可以随机的产生不同的结果（outcomes）。则概率论和统计学的区别可以描述为：
    - `概率论`（probability theory）中，已知该过程的概率模型，该模型的不确定性由相应的概率分布来描述；概率论要回答的问题是该过程产生某个结果的可能性有多大这类问题。
    - `统计学`（statistics）中，该过程的概率模型是未知的，但是有一系列该过程产生的结果的观测值；希望通过这些观测值来推断出这个过程中的不确定性是什么样的。
  - 总结来说就是：（类似归纳与演绎）
    - 通过已知的概率模型来精确的计算各种结果的可能性就是`概率论`；——`演绎`
    - 根据观测的结果来推断模型的不确定性就是`统计学`。——`归纳`


## 频率学派与贝叶斯学派


- [马同学高等数学](https://www.matongxue.com/lessons/686/)

|维度|频率派|古典派|主观派|
|---|---|----|---|
|理论基础|过往事实的归纳总结|不充分理由原则|知识和直觉|
|概率定义|频率稳定性|等概率|信念强度|

- 注：`不充分理由原则`
>雅各布·伯努利（1654－1705）提出，如果因为无知而没办法判断哪一个结果更容易出现，那么应该给予它们相同的概率

- 以不充分理由原则为基础，经由皮埃尔-西蒙·拉普拉斯侯爵（1749－1827）之手，确立了 古典概率 的定义，即：
>未知的概率都为等概率

- 整个19世纪的人们都广泛接受这个定义，并发展出了一系列的定义和定理。
- `贝特朗悖论`：法国数学家贝特朗（也翻译为“伯特兰”）于1888年在他的著作《Calcul des probabilités》中提到了这个悖论，锯木厂的木头，人们开始反思古典概率中的不合理之处：**“等概率”的描述实在是太模糊了，存在歧义**。
  - 边长的分布是未知的，所以是等概率的
  - 面积的分布是未知的，所以是等概率的
- 现代概率论通过分布来描述边长的随机性后，这种模糊性消失了，贝特朗悖论解决

**古典统计学和贝叶斯统计学**

- 统计学领域中有两大学派：`古典统计学`（classical）和`贝叶斯统计学`（Bayesian，以英国数学家托马斯•贝叶斯命名）。古典统计学又称为`频率论`（frequentist）。
- 关于这俩大学派孰优孰劣已有一个世纪的争论。它们的本质区别在于对待未知模型或者参数的方法是不同的：
  - ![](http://p1-tt.byteimg.com/large/a06f00023320ec9a1b61)
  - 古典统计学认为，未知的模型或者参数是**确定**的，只不过我们不知道它确切的形式或者取值。
    - 古典统计学通过进行大量重复实验并统计某个特定结果出现的频率作为对未知参数的估计。
    - 大数定律
  - 贝叶斯统计学认为，未知的模型或者参数变量是**不确定**的，但是这种不确定性可以由一个概率分布来描述。
    - 贝叶斯统计学“使用概率的方法来解决统计学问题”——贝叶斯公式+主观概率
      - `先验分布`（prior distribution）：根据主观判断或者过去的经验，猜测概率分布
      - `后验分布`（posterior distribution）：根据越来越多的观测值（new data 或者 new evidence）来修正猜测得到的概率分布
    - 贝叶斯统计学中的“概率”的概念可以被解释为对未知变量不同取值的信心程度的测度（measure of confidence）
    - 贝叶斯统计学派被古典统计学派诟病的核心问题是对于未知变量的先验分布是非常主观的。
    - 适合场景：选举、疾病诊断
      - 无法大量重复试验
      - 合理的先验分布对未知量的估计是非常有益的
    - 关于贝叶斯统计的一个笑话，代表着很多吃瓜群众对贝叶斯统计的看法，以及贝叶斯统计学派的自嘲：
>- A Bayesian is one who, vaguely expecting a horse, and catching a glimpse of a donkey, strongly believes he has seen a mule.
>- 一个贝叶斯学派的学者是这样的：模糊的期待着一匹马（**先验**），却看到了一头驴（**证据**），于是便自信的认为那是一头骡子（**后验**）。

- [频率学派与贝叶斯学派之争](http://www.cnblogs.com/549294286/archive/2013/04/08/3009073.html)：[知乎网友解释](https://www.zhihu.com/question/20587681/answer/21294468),频率学派最先出现，疯狂打压新生的贝叶斯学派，贝叶斯很凄惨，就跟艺术圈的梵高一样，死后的论文才被自己的学生发表，经过拉普拉斯之手发扬光大，目前二派就像华山派的剑宗和气宗。频率学派挺煞笔的，非得做大量实验才能给出结论，比如你今年高考考上北大的概率是多少啊？频率学派就让你考100次，然后用考上的次数除以100。而贝叶斯学派会找几个高考特级教师对你进行一下考前测验和评估，然后让这几个教师给出一个主观的可能性，比如说：你有9成的把握考上北大。
   - 这个区别说大也大，说小也小。（1）往大里说，世界观就不同，频率派认为参数是客观存在，不会改变，虽然未知，但却是固定值；贝叶斯派则认为参数是随机值，因为没有观察到，那么和是一个随机数也没有什么区别，因此参数也可以有分布，个人认为这个和量子力学某些观点不谋而合。（2） 往小处说，频率派最常关心的是似然函数，而贝叶斯派最常关心的是后验分布。我们会发现，后验分布其实就是似然函数乘以先验分布再normalize一下使其积分到1。因此两者的很多方法都是相通的。贝叶斯派因为所有的参数都是随机变量，都有分布，因此可以使用一些基于采样的方法（如MCMC）使得我们更容易构建复杂模型。频率派的优点则是没有假设一个先验分布，因此更加客观，也更加无偏，在一些保守的领域（比如制药业、法律）比贝叶斯方法更受到信任。
   - 频率 vs 贝叶斯 =   P(X;w)  vs  P(X\|w) 或 P(X,w)
   - 频率学派认为参数固定，通过无数字实验可以估计出参数值——客观；
   - 贝叶斯学派认为参数和数据都是随机的，参数也服从一定的分布，需要借助经验——主观

## 参数估计

- 【2020-8-1】[三种参数估计方法](https://learning.snssdk.com/feoffline/toutiao_wallet_bundles/toutiao_learning_wap/online/article.html?item_id=6772498016138953223&app_name=news_article)

- 两大流派：
  - `频率学派`：参数未知但固定。`极大似然估计`MLE（`点估计`）
  - `贝叶斯学派`：参数未知且变化。`最大后验估计`MAP（`点估计`）、`贝叶斯估计`（`分布估计`）
  - 注：频率是贝叶斯的一个特例，隐含了先验知识
- 方法
  - `极大似然估计`：用样本数据进行点估计
  - `最大后验估计`：用样本数据+先验知识进行点估计
  - `贝叶斯估计`：用样本数据+先验知识进行分布估计


![](https://p3.pstatp.com/large/pgc-image/8b8e3f3de8a84894a52ccbe1877bfb7e)
![](https://p3.pstatp.com/large/pgc-image/8d065abba83141e3aca9f7f4e60c4b85)


## 矩

【2020-5-29】用4个数来概括一个分布
- mean: 第一矩。表位置
- variance: 第二矩。表胖瘦
- skewness: 第三矩。表歪斜
- kurtosis: 第四矩。表尾巴胖瘦

- 力学上的矩，质量（mass）：
  - 0 阶矩：是总质量；
  - 1 阶矩除以总质量是质心（质量中心）；
  - 2 阶矩是惯性矩（moment of inertia）

- 统计学上的矩
  - 0 阶矩：`总概率`，也就是 1；
  - 1 阶矩：`均值`，
  - 2 阶中心矩：`方差`；如果是多元，对应协方差
  - 3 阶中心矩：`偏度`（skewness）
  - 4 阶中心矩（归一化和平移）：`峰态`（kurtosis）


# [深入讲解贝叶斯背后的哲学与数学思想](https://www.toutiao.com/i6646199526229017102/?tt_from=mobile_qq&utm_campaign=client_share&timestamp=1595428970&app=news_article&utm_source=mobile_qq&utm_medium=toutiao_android&use_new_style=1&req_id=20200722224250010027057086161C5AB3&group_id=6646199526229017102)

 
- 2019-01-14 12:13:57
 
数理统计中有**频率学派**和**贝叶斯学派**之分。关于两者的差异，众说纷纭，网上博客、知乎有专门的讨论。
 
> 然而，从更高的哲学上看待这个问题，就会发觉，贝叶斯论和频率论的真正区别在于**人们如何解释概率之间的哲学差异**。

本文将透彻分析贝叶斯背后的哲学与数学思想。让大家从一个更高的视角来把应用贝叶斯思想及推理，不光是应用于机器学习算法，还能指导工作生活。
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/cf9c27bd305741ae847ede8e7e95a563)
 
## 贝叶斯定理的证据思想
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/36a3553db51c419e8825afda37836ce0)
 
将A视为关于世界的一些命题，将B视为一些数据或证据。例如，A代表今天下雨的命题，B代表外面人行道潮湿的证据，那么分析一下这个贝叶斯推理过程的思想。
 
p（雨\|湿） 问道，"外面潮湿，下雨的几率是多少？" 为了评估这个问题，让我们来看看方程式的右侧。在看地面之前，下雨的概率是多少， p（下雨）？将此视为对世界的假设的合理性。然后我们问在这个假设下，外面潮湿的观察有多少可能性， 即p（潮湿\|下雨）？根据证据，这个过程有效地更新了我们对一个命题的初步信念，在一些观察的支持下最终衡量了降雨的合理性。
 
> 我们的初始信念由先验分布p（下雨）表示，我们的最终信念由后验分布p（雨\|湿）表示。分母只是问："证据的总合理性是多少？"，我们必须考虑所有假设，以确保后验是一个合适的概率分布。
 
这种思维方式可以帮助你摆脱对世界的黑白解释，而不是通过概率镜头来观察事物和解释。
 
从一个基于证据的世界观开始，如果引入新证据，你的初始世界观的概率会发生变化。
 
## 贝叶斯哲学本质：动态的看待世界
 
贝叶斯定理本质：
 
> 贝叶斯定理是一种基于最佳可用证据（观察，数据，信息）计算信念（假设，主张，命题）的有效性的方法。最本真的描述：最初的信念加上新的证据=新的和改进的信念。
 
所以你对自己信仰的确定性并不是固定的，而是流动的、可塑的。您应该能够根据新证据修改您的意见。
 
辩证法强调不要静止的看问题，要动态的看问题。所以为突出强调动态看问题的哲学思想，进一步的描述为：
 
我们用客观信息修改我们的观点：初始信念+最近的客观数据=新的和改进的信念。每次重新计算系统时，后验都成为新迭代的先验。这是一个不断发展的系统，每一点新信息都越来越接近于确定性。
 
这种思维方式可以帮助人们减少确认偏差的影响，从而开启对新可能性的看法。
 
贝叶斯推理过程，是一个不断修正的趋近于真理的过程。
 
贝叶斯定理的另一个用法是判断一个假设发生在另一个假设上的可能性。
 
中心前提是第一原则，即这个世界上大多数事物都是不确定的。很多时候你没有完美的信息，你不知道一切，你需要做出推论。
 
贝叶斯定理，在一个充满不确定性的世界中，为我们的决策提供信息。随着新信息的出现，需要反思这些新证据如何改变对事物的看法，然后根据它进行修正。
 
## 贝叶斯哲学精神：科学的客观性和精确性
 
伯茨麦格雷恩有一个对贝叶斯的经典陈述：
 
> 贝叶斯坚信，现代科学需要客观性和精确性。贝叶斯是信仰的衡量标准。它说我们甚至可以从缺失和不充分的数据，近似和无知中学到东西。
 
随着人们开始认识到人类思考和决策方式的固有不完善性，贝叶斯思想的应用正在不断增长。
 
很长一段时间，经典的经济学模型将人视为理性行为者，在开明的自我利益的基础上做出决策是完美的。现在我们开始意识到这种观点是有缺陷的，相反，人类行为经济学作为认知偏见的牺牲品的观点正变得越来越普遍。
 
贝叶斯思维也是我们学习方法的一个很好的近似。纳特•西尔弗在《信号与噪音》中说：
 
" 相反，它（贝叶斯定理）是一种在数学和哲学上表达我们如何了解宇宙的声明：我们通过近似来了解它，在我们收集更多证据时越来越接近真相。"
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/28f881b2ea8a46e6bbc4ea29dcaafcdd)
 
## 贝叶斯数学思想：用数据调整先验
 
贝叶斯推理是非常强大的工具，可用于对任何随机变量进行建模，例如回归参数的值、人口统计数据、业务KPI或单词的词性。对于在机器学习建模中当数据有限、担心过拟合等情况下更有非常有用。
 
> 接下来通过高斯分布估计来讲解贝叶斯在应用于参数估计中的数学思想与方法。
 
在分布参数前提下的数据的概率：条件概率分布
 
假设我们给出了高斯随机变量X的样本数据集，D = {x1，...，xN}，并且给出数据的方差是σ2
 
我们对μ的最佳猜测是什么？这里假设数据是独立的并且分布相同。
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/877d431ec6dc449da4d9330dca78ca45?from=pc)
 
把高斯分布写成似然函数的形式如下，就是在当前参数下数据发生的概率密度函数:
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/c9d5f1a7743c48e4af1276d993478846?from=pc)
 
我们希望选择最大化此表达式的μ。
 
### 贝叶斯概率
 
对于上边高斯分布参数估计，我们用贝叶斯定理的思想解决，我们的目的是求得参数，换作概率的表达就是，求在参数d的概率条件下的θ的概率，即p(θ\|d)：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/e285a88d27d44ed28ec33a4af20a2ab3)
 
p(d|θ)是似然函数，概率的形式，实质上就是上文中写成条件概率形式的概率密度函数。p(θ)
 
是先验概率（先前的信念）。
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p1-tt.byteimg.com/large/pgc-image/a3aff297edea4c02995c23a2f890e14f)
 
归一化常数，也就是证据的总合理性量度，必须考虑所有假设。p(θ|d)是后验分布，在面对数据时重新调整我们先前的信念（先验概率）。
 
> 这样，我们就把一个求取参数的过程转化为贝叶斯定理的求解过程。
 
### 最大后验概率估计MAP
 
在高斯分布估计中，假设我们事先认为某个随机变量X的平均值是μ0，我们的信念的方差是σ02，然后我们给出X的样本数据集，d = {x1，...，xN}，如下图所示，并且以某种方式知道数据的方差是σ2，本文只给出求取一个参数的情况。
 
现在求后验分布参数μ？
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p1-tt.byteimg.com/large/pgc-image/30c2ec2be2c54961a7c168cd2291c511?from=pc)
 
上面的假设，已知知道高斯分布两个参数如下，即先验。
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p1-tt.byteimg.com/large/pgc-image/66ee3636792944b1ab991823cfee9624?from=pc)
 
根据贝叶斯概率，我们所求即为：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/296c80b35db64a6e82b89ef269e82c30?from=pc)
 
p(d|u)是似然函数，如下图所示：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p6-tt.byteimg.com/large/pgc-image/00392efe032a44139237fbe0b23990f5?from=pc)
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p6-tt.byteimg.com/large/pgc-image/1013e77550fc4039a493d8ad82389955?from=pc)
 
p(u)是μ的先验概率：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/0782d6b47d424ada910dbc2ad7c02094?from=pc)
 
后验概率可写为：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p1-tt.byteimg.com/large/pgc-image/f826d50cd9ca4e119d542fdb003b3cc7?from=pc)
 
根据两个高斯分布的乘积也是高斯分布，后验概率也是高斯：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p6-tt.byteimg.com/large/pgc-image/f4fe91a851554cd89c7739d62ce2501a?from=pc)
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p1-tt.byteimg.com/large/pgc-image/5220941b697f444f9a353d903f08e46b?from=pc)
 
通过变换形式，最后得到：
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/c4c2709365a24ad79f90dfa8faaa92af?from=pc)
 
![深入讲解贝叶斯背后的哲学与数学思想](http://p3-tt.byteimg.com/large/pgc-image/e6d504cc172144b0b789b3d3be8ce2f9?from=pc)




# 结束


